import codecs
import struct

def isengnum(char):
    charset=u'0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_#%-\\'
    if char in charset:
        return True
    else:
        return False

def iseng(char):
    charset=u'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_'
    if char in charset:
        return True
    else:
        return False

def allareeng(charlist):
    ret=True
    for char in charlist:
        ret=ret and iseng(char)
    return ret
    
def outputlist(stringlist1):
    textfile=file('1.txt','w')
    textfile.write(codecs.BOM_UTF8)
    i=0
    while i < len(stringlist1):
        textfile.write((stringlist1[i]+'\n').encode('utf8'))
        i+=1
    textfile.close()

def del_blank(charlist):
    i=0
    startpos=0
    while i<len(charlist) and (charlist[i]==u' ' or charlist[i]==u'\t' or charlist[i]==u'\r' or charlist[i]==u'\0'):
        i+=1
        startpos=i
    i=len(charlist)-1
    endpos=i
    while i>=0 and (charlist[i]==u' ' or charlist[i]==u'\t' or charlist[i]==u'\r' or charlist[i]==u'\0'):
        i-=1
        endpos=i
    i=startpos
    newcharlist=''
    while i<endpos+1:
        if charlist[i]==u'\0':
            newcharlist+=u' '
        else:
            newcharlist+=charlist[i]
        i+=1
    return newcharlist

#list all the names
def name_list():
    names=[]
    i=0
    while i < len(command):
        if command[i]==u'Talk':
            if isengnum(command[i-1][0]):
                name=command[i-2]
            else:
                name=command[i-1]
            if del_blank(name) not in names:
                names.append(del_blank(name))
                print name
        i+=1
    outputlist(names)

def name_mapping(filename):
    configfile=file(filename,'r')
    names={}
    while True:
        line=configfile.readline()
        if len(line)==0:
            break
        if line[:3] == codecs.BOM_UTF8:
            command=line[3:].decode('utf8')
        else:
            command=line.decode('utf8')
        args=command[:-1].split(',')
        names[args[0]]=args[1]
    configfile.close()
    return names

def readyosugafile(filename):
    configfile=file(filename,'r')
    names=[]
    while True:
        line=configfile.readline()
        if len(line)==0:
            break
        if line[:3] == codecs.BOM_UTF8:
            command=line[3:].decode('utf8')
        else:
            command=line.decode('utf8')
        names.append(command[:-1])
    configfile.close()
    return names

def fixyosugafile(command):
    global i
    i=3397
    script=[]
    cachename=u''
    while i < len(command)-1:
        if len(command[i])>1:
            if command[i][0]=='\xE3\x80\x90'.decode('utf8'):
                if not isengnum(command[i][1]):
                    if cachename==u'':
                         cachename=command[i]
                    else:
                         print 'name conflict at line',i
            else:
                if isengnum(command[i][0]) and command[i][0:5]!=u'__SEL':
                    script.append(command[i])
                else:
                    script.append(cachename)
                    script.append(command[i])
                    cachename=u''
        else:
            print 'command not long enough at line',i
            
        i+=1
    return script

def parse_script(command):
    i=12000
    name=u''
    name_list=name_mapping('name_list.txt')
    voice_list=name_mapping('voice.txt')
    script=[]
    needdelcg=False
    bgdict={u'EB06a':(800,858),u'EB06b':(800,858),u'EC06a':(800,969),u'EC06b':(800,969),u'B24a':(800,1200),u'B24a_':(800,1200),u'B27a':(800,1200),u'B27a_':(800,1200),u'B27b':(800,1200),u'B27b_':(800,1200),u'B27c':(800,1200),u'B27d':(800,1200),u'B28d':(800,1200),u'B37a':(800,1201),u'B37a_':(800,1201),u'EA08a':(800,1300),u'EA08b':(800,1300),u'EA08c':(800,1300),u'EA06a':(1069,866),u'EA06b':(1069,866),u'EA06c':(1069,866),u'B36a':(1400,600),u'B36a_':(1400,600),u'B36b':(1400,600),u'B20a':(1708,600),u'B20b':(1708,600),u'B34a':(1766,600),u'B34a_':(1766,600),u'B34b':(1766,600),u'B34c':(1766,600)}
    while i < len(command):
        #Audio
        if command[i]==u'ScPlayBgm':
            script.append('bgm "'+command[i-2]+'.mp3"')
        elif command[i]==u'ScPauseBgm' or command[i]==u'ScStopBgm':
            script.append('bgmstop')
        elif command[i]==u'ScPlayEnvSe':
            if command[i-2].isdigit():
                script.append('dwaveloop 2,"sound/'+command[i-3].lower()+'.ogg"')
            else:
                script.append('dwaveloop 2,"sound/'+command[i-2].lower()+'.ogg"')
        elif command[i]==u'ScPlaySe':
                script.append('dwave 1,"sound/'+command[i-2].lower()+'.ogg"')
        elif command[i]==u'ScStopSe':
            script.append('dwavestop 1')
        elif command[i]==u'ScStopEnvSe':
            script.append('dwavestop 2')
        #Image
        elif command[i]==u'SetCg' and (command[i-3]!=u'ImageBoard' and command[i-3]!=u'pub1'):
            cgname=command[i-3]
            cgstartx=command[i-2]
            cgstarty=command[i-1]
            if command[i-1]==u'0' and command[i-2]==u'0':
                if needdelcg:
                    script.append('delcg')
                    needdelcg=False
                script.append('bg "bg/'+command[i-3]+'.png"')                
            else:
                script.append('SetCg "'+command[i-3]+'",'+command[i-2]+','+command[i-1])
                needdelcg=True
        elif command[i]==u'Scroll':
            script.append('Scroll "'+cgname+'",'+cgstartx+','+cgstarty+','+command[i-5]+','+command[i-4])
            needdelcg=True
        elif command[i]==u'SetCgRGB':
            if needdelcg:
                script.append('delcg')
                needdelcg=False
            color=hex(int(command[i-3])*256*256+int(command[i-2])*256+int(command[i-1]))[2:]
            if len(color)==4:
                color='00'+color
            print color
            script.append('bg #'+color)
        elif command[i]==u'Transition':
            if command[i-2].startswith(u'SetCg'):
                script.append('Transitiontime '+command[i-1])
            else:
                script.append('Transitionmask '+command[i-1]+','+command[i-2])
        elif command[i]==u'BlackOut':
            if needdelcg:
                script.append('delcg')
                needdelcg=False
            script.append('bg #000000')
        elif command[i]==u'WhiteOut':
            if needdelcg:
                script.append('delcg')
                needdelcg=False
            script.append('bg #FFFFFF')
        elif command[i]==u'Flush':
            if command[i-2]==u'RED':
                command[i-2]=u'#FF0000'
            else:
                command[i-2]=u'#FFFFFF'
            script.append('flush '+command[i-2]+','+command[i-1])
        #chara
        elif command[i]==u'SetBustup':
            if command[i-3]!=u'' and command[i-3]!=u' ':
                script.append('#CHR_DSP '+command[i-3])
        elif command[i]==u'BustupLeave' or command[i]==u'BustupClear':
            script.append('#CHR_ERSW')
        #misc
##        elif command[i]==u'OnGameClear':
##            script.append('#BG_DSP BLACK')
##            script.append('#WAIT 120')
##            script.append('#BGM_STP')
##            script.append('#RSET S01,1')
##            script.append('#BG_DSP logo2')
##            script.append('#WAIT 60')
##            script.append('#change OINI')
##            script.append('#FILE 00_001')
        elif command[i]==u'ScPlayMovie':
            script.append('mpegplay "'+command[i-1]+'.mp4",1')
        elif command[i]==u'Quake':
            script.append('Quake')
        elif command[i]==u'Shake':
            script.append('Shake')
        elif command[i]==u'ScWait':
            script.append('wait '+command[i-2])
##        elif command[i]==u'Change':
##            if command[i-1]!=u'EXIT_SCENARIO':
##                script.append('#change '+command[i-1])
##                if command[i-1]==u'00_g000':
##                    script.append('#FILE 00_e009b')
##                elif command[i-1]==u'00_g001':
##                    script.append('#FILE 00_e013a')
##                elif command[i-1]==u'00_g003':
##                    script.append('#FILE 00_e018')
##                elif command[i-1]==u'00_e009b':
##                    script.append('#FILE 00_g001')
##                elif command[i-1]==u'00_e013a':
##                    script.append('#FILE 00_g003')
##                elif command[i-1]==u'00_e018':
##                    script.append('#FILE 00_z000')
##                else:
##                    script.append('#FILE '+command[i-1])
##        elif command[i]==u'EyeCatchEnter':
##            script.append('#CHR_DSPM DATE,50,0,60')
##            script.append('#WAIT 240')
##            script.append('#BG_DSP BLACK')
##            script.append('#WAIT 60')
        elif command[i]==u'WindowView':
            if command[i-1]==u'0':
                script.append('textwin')
            else:
                script.append('textwin2')
        elif command[i]==u'Jump':
            script.append('Jump')
        elif command[i]==u'Down':
            script.append('Down')
        elif command[i]==u'EyeCatchEnter':
            script.append('EyeCatchEnter')
        #Talk
        if command[i]==u'Talk':
            if isengnum(command[i-1][0]):
                name=name_list[del_blank(command[i-2])]
                script.append('dwave 0,"voice/'+command[i-1]+'.ogg"')#voice_list[command[i-1]])
            else:
                name=name_list[del_blank(command[i-1])]
            if name!=u'':
                script.append('\xE3\x80\x90'.decode('utf8')+name+'\xE3\x80\x91'.decode('utf8'))
                script.append('\xE3\x80\x8C'.decode('utf8')+command[i+1]+'\xE3\x80\x8D'.decode('utf8')+'\\')
            else:
                script.append(command[i+1]+'\\')
        else:
            name==u''
        i+=1
    return script

def chara_in_list(chara_list,chara):
    for i in range(0,len(chara_list)):
        if chara[0:2]!='EZ' and chara[0:2]==chara_list[i][0:2]:
            return i
    return -1

def modify_script(command):
    global chara_list,i
    script=[]
    chara_list=[]
    chrdict={u"EZ01CF04b":(233,480),u"EZ01CA01a":(167,310),u"EZ01CA01b":(167,310),u"EZ01CA02a":(167,310),u"EZ01CA02b":(167,310),u"EZ01CB01a":(243,540),u"EZ01CB01b":(243,540),u"EZ01CB02a":(243,540),u"EZ01CB02b":(243,540),u"EZ01CB03a":(243,540),u"EZ01CB03b":(243,540),u"EZ01CC01a":(184,364),u"EZ01CC01b":(184,364),u"EZ01CC02a":(184,364),u"EZ01CC02b":(184,364),u"EZ01CC03a":(184,364),u"EZ01CC03b":(184,364),u"EZ01CD01a":(189,380),u"EZ01CD01b":(189,380),u"EZ01CD02a":(189,380),u"EZ01CD02b":(189,380),u"EZ01CF01a":(233,480),u"EZ01CF01b":(233,480),u"EZ01CF02a":(233,480),u"EZ01CF02b":(233,480),u"EZ01CF03a":(233,480),u"EZ01CF03b":(233,480),u"EZ01CF04a":(233,480),u"CC01_01M":(546,570),u"CC01_01S":(425,637),u"CA01_01L":(956,608),u"CA01_01M":(557,528),u"CA01_01S":(403,522),u"CA01_02L":(956,608),u"CA01_02M":(557,528),u"CA01_02S":(403,522),u"CA01_03L":(956,608),u"CA01_03M":(557,528),u"CA01_03S":(403,522),u"CA01_04L":(794,608),u"CA01_04M":(476,528),u"CA01_04S":(335,521),u"CA01_05L":(794,608),u"CA01_05M":(476,528),u"CA01_05S":(335,521),u"CA01_06L":(956,608),u"CA01_06M":(557,528),u"CA01_06S":(403,522),u"CA01_07L":(794,608),u"CA01_07M":(476,528),u"CA01_07S":(335,521),u"CA01_08L":(956,608),u"CA01_08M":(557,528),u"CA01_08S":(403,522),u"CA01_09L":(794,608),u"CA01_09M":(476,528),u"CA01_09S":(335,521),u"CA01_10L":(956,608),u"CA01_10M":(557,528),u"CA01_10S":(403,522),u"CA01_11L":(794,608),u"CA01_11M":(476,528),u"CA01_11S":(335,521),u"CA01_12L":(956,608),u"CA01_12M":(557,528),u"CA01_12S":(403,522),u"CA01_13L":(956,608),u"CA01_13M":(557,528),u"CA01_13S":(403,522),u"CA02_01L":(787,608),u"CA02_01M":(588,528),u"CA02_01S":(452,522),u"CA02_02L":(787,608),u"CA02_02M":(588,528),u"CA02_02S":(452,522),u"CA02_03L":(787,608),u"CA02_03M":(588,528),u"CA02_03S":(452,522),u"CA02_04L":(754,608),u"CA02_04M":(476,528),u"CA02_04S":(388,521),u"CA02_05L":(754,608),u"CA02_05M":(476,528),u"CA02_05S":(388,521),u"CA02_06L":(787,608),u"CA02_06M":(588,528),u"CA02_06S":(452,522),u"CA02_07L":(754,608),u"CA02_07M":(476,528),u"CA02_07S":(388,521),u"CA02_08L":(787,608),u"CA02_08M":(588,528),u"CA02_08S":(452,522),u"CA02_09L":(754,608),u"CA02_09M":(476,528),u"CA02_09S":(388,521),u"CA02_10L":(787,608),u"CA02_10M":(588,528),u"CA02_10S":(452,522),u"CA02_11L":(754,608),u"CA02_11M":(476,528),u"CA02_11S":(388,521),u"CA02_12L":(787,608),u"CA02_12M":(588,528),u"CA02_12S":(452,522),u"CA02_13L":(787,608),u"CA02_13M":(588,528),u"CA02_13S":(452,522),u"CA03_01L":(956,608),u"CA03_01M":(557,528),u"CA03_01S":(403,522),u"CA03_02L":(956,608),u"CA03_02M":(557,528),u"CA03_02S":(403,522),u"CA03_03L":(956,608),u"CA03_03M":(557,528),u"CA03_03S":(403,522),u"CA03_04L":(794,608),u"CA03_04M":(476,528),u"CA03_04S":(335,521),u"CA03_05L":(794,608),u"CA03_05M":(476,528),u"CA03_05S":(335,521),u"CA03_06L":(956,608),u"CA03_06M":(557,528),u"CA03_06S":(403,522),u"CA03_07L":(794,608),u"CA03_07M":(476,528),u"CA03_07S":(335,521),u"CA03_08L":(956,608),u"CA03_08M":(557,528),u"CA03_08S":(403,522),u"CA03_09L":(794,608),u"CA03_09M":(476,528),u"CA03_09S":(335,521),u"CA03_10L":(956,608),u"CA03_10M":(557,528),u"CA03_10S":(403,522),u"CA03_11L":(794,608),u"CA03_11M":(476,528),u"CA03_11S":(335,521),u"CA03_12L":(956,608),u"CA03_12M":(557,528),u"CA03_12S":(403,522),u"CA03_13L":(956,608),u"CA03_13M":(557,528),u"CA03_13S":(403,522),u"CA04_01L":(956,608),u"CA04_01M":(557,528),u"CA04_01S":(403,522),u"CA04_02L":(956,608),u"CA04_02M":(557,528),u"CA04_02S":(403,522),u"CA04_03L":(956,608),u"CA04_03M":(557,528),u"CA04_03S":(403,522),u"CA04_04L":(794,608),u"CA04_04M":(476,528),u"CA04_04S":(335,521),u"CA04_05L":(794,608),u"CA04_05M":(476,528),u"CA04_05S":(335,521),u"CA04_06L":(956,608),u"CA04_06M":(557,528),u"CA04_06S":(403,522),u"CA04_07L":(794,608),u"CA04_07M":(476,528),u"CA04_07S":(335,521),u"CA04_08L":(956,608),u"CA04_08M":(557,528),u"CA04_08S":(403,522),u"CA04_09L":(794,608),u"CA04_09M":(476,528),u"CA04_09S":(335,521),u"CA04_10L":(956,608),u"CA04_10M":(557,528),u"CA04_10S":(403,522),u"CA04_11L":(794,608),u"CA04_11M":(476,528),u"CA04_11S":(335,521),u"CA04_12L":(956,608),u"CA04_12M":(557,528),u"CA04_12S":(403,522),u"CA04_13L":(956,608),u"CA04_13M":(557,528),u"CA04_13S":(403,522),u"CA05_01L":(956,608),u"CA05_01M":(557,528),u"CA05_01S":(403,522),u"CA05_02L":(956,608),u"CA05_02M":(557,528),u"CA05_02S":(403,522),u"CA05_03L":(956,608),u"CA05_03M":(557,528),u"CA05_03S":(403,522),u"CA05_04L":(794,608),u"CA05_04M":(476,528),u"CA05_04S":(335,521),u"CA05_05L":(794,608),u"CA05_05M":(476,528),u"CA05_05S":(335,521),u"CA05_06L":(956,608),u"CA05_06M":(557,528),u"CA05_06S":(403,522),u"CA05_07L":(794,608),u"CA05_07M":(476,528),u"CA05_07S":(335,521),u"CA05_08L":(956,608),u"CA05_08M":(557,528),u"CA05_08S":(403,522),u"CA05_09L":(794,608),u"CA05_09M":(476,528),u"CA05_09S":(335,521),u"CA05_10L":(956,608),u"CA05_10M":(557,528),u"CA05_10S":(403,522),u"CA05_11L":(794,608),u"CA05_11M":(476,528),u"CA05_11S":(335,521),u"CA05_12L":(956,608),u"CA05_12M":(557,528),u"CA05_12S":(403,522),u"CA05_13L":(956,608),u"CA05_13M":(557,528),u"CA05_13S":(403,522),u"CA06_01L":(956,608),u"CA06_01M":(557,528),u"CA06_01S":(403,522),u"CA06_02L":(956,608),u"CA06_02M":(557,528),u"CA06_02S":(403,522),u"CA06_03L":(956,608),u"CA06_03M":(557,528),u"CA06_03S":(403,522),u"CA06_04L":(794,608),u"CA06_04M":(476,528),u"CA06_04S":(335,521),u"CA06_05L":(794,608),u"CA06_05M":(476,528),u"CA06_05S":(335,521),u"CA06_06L":(956,608),u"CA06_06M":(557,528),u"CA06_06S":(403,522),u"CA06_07L":(794,608),u"CA06_07M":(476,528),u"CA06_07S":(335,521),u"CA06_08L":(956,608),u"CA06_08M":(557,528),u"CA06_08S":(403,522),u"CA06_09L":(794,608),u"CA06_09M":(476,528),u"CA06_09S":(335,521),u"CA06_10L":(956,608),u"CA06_10M":(557,528),u"CA06_10S":(403,522),u"CA06_11L":(794,608),u"CA06_11M":(476,528),u"CA06_11S":(335,521),u"CA06_12L":(956,608),u"CA06_12M":(557,528),u"CA06_12S":(403,522),u"CA06_13L":(956,608),u"CA06_13M":(557,528),u"CA06_13S":(403,522),u"CA07_01L":(956,608),u"CA07_01M":(557,528),u"CA07_01S":(403,522),u"CA07_02L":(956,608),u"CA07_02M":(557,528),u"CA07_02S":(403,522),u"CA07_03L":(956,608),u"CA07_03M":(557,528),u"CA07_03S":(403,522),u"CA07_04L":(794,608),u"CA07_04M":(476,528),u"CA07_04S":(335,521),u"CA07_05L":(794,608),u"CA07_05M":(476,528),u"CA07_05S":(335,521),u"CA07_06L":(956,608),u"CA07_06M":(557,528),u"CA07_06S":(403,522),u"CA07_07L":(794,608),u"CA07_07M":(476,528),u"CA07_07S":(335,521),u"CA07_08L":(956,608),u"CA07_08M":(557,528),u"CA07_08S":(403,522),u"CA07_09L":(794,608),u"CA07_09M":(476,528),u"CA07_09S":(335,521),u"CA07_10L":(956,608),u"CA07_10M":(557,528),u"CA07_10S":(403,522),u"CA07_11L":(794,608),u"CA07_11M":(476,528),u"CA07_11S":(335,521),u"CA07_12L":(956,608),u"CA07_12M":(557,528),u"CA07_12S":(403,522),u"CA07_13L":(956,608),u"CA07_13M":(557,528),u"CA07_13S":(403,522),u"CB01_01L":(730,681),u"CB01_01M":(394,595),u"CB01_01S":(297,578),u"CB01_02L":(885,688),u"CB01_02M":(460,599),u"CB01_02S":(348,580),u"CB01_03L":(885,688),u"CB01_03M":(460,599),u"CB01_03S":(348,580),u"CB01_04L":(885,688),u"CB01_04M":(460,599),u"CB01_04S":(348,580),u"CB01_05L":(730,681),u"CB01_05M":(394,595),u"CB01_05S":(297,578),u"CB01_06L":(730,681),u"CB01_06M":(394,595),u"CB01_06S":(297,578),u"CB01_07L":(730,681),u"CB01_07M":(394,595),u"CB01_07S":(297,578),u"CB01_08L":(730,681),u"CB01_08M":(394,595),u"CB01_08S":(297,578),u"CB01_09L":(730,681),u"CB01_09M":(394,595),u"CB01_09S":(297,578),u"CB01_10L":(730,681),u"CB01_10M":(394,595),u"CB01_10S":(297,578),u"CB01_11L":(730,681),u"CB01_11M":(394,595),u"CB01_11S":(297,578),u"CB01_12L":(730,681),u"CB01_12M":(394,595),u"CB01_12S":(297,578),u"CB01_13L":(885,688),u"CB01_13M":(460,599),u"CB01_13S":(348,580),u"CB02_01L":(730,681),u"CB02_01M":(394,595),u"CB02_01S":(297,578),u"CB02_02L":(885,688),u"CB02_02M":(460,599),u"CB02_02S":(348,580),u"CB02_03L":(885,688),u"CB02_03M":(460,599),u"CB02_03S":(348,580),u"CB02_04L":(885,688),u"CB02_04M":(460,599),u"CB02_04S":(348,580),u"CB02_05L":(730,681),u"CB02_05M":(394,595),u"CB02_05S":(297,578),u"CB02_06L":(730,681),u"CB02_06M":(394,595),u"CB02_06S":(297,578),u"CB02_07L":(730,681),u"CB02_07M":(394,595),u"CB02_07S":(297,578),u"CB02_08L":(730,681),u"CB02_08M":(394,595),u"CB02_08S":(297,578),u"CB02_09L":(730,681),u"CB02_09M":(394,595),u"CB02_09S":(297,578),u"CB02_10L":(730,681),u"CB02_10M":(394,595),u"CB02_10S":(297,578),u"CB02_11L":(730,681),u"CB02_11M":(394,595),u"CB02_11S":(297,578),u"CB02_12L":(730,681),u"CB02_12M":(394,595),u"CB02_12S":(297,578),u"CB02_13L":(885,688),u"CB02_13M":(460,599),u"CB02_13S":(348,580),u"CB03_01L":(730,681),u"CB03_01M":(394,595),u"CB03_01S":(297,578),u"CB03_02L":(885,688),u"CB03_02M":(460,599),u"CB03_02S":(348,580),u"CB03_03L":(885,688),u"CB03_03M":(460,599),u"CB03_03S":(348,580),u"CB03_04L":(885,688),u"CB03_04M":(460,599),u"CB03_04S":(348,580),u"CB03_05L":(730,681),u"CB03_05M":(394,595),u"CB03_05S":(297,578),u"CB03_06L":(730,681),u"CB03_06M":(394,595),u"CB03_06S":(297,578),u"CB03_07L":(730,681),u"CB03_07M":(394,595),u"CB03_07S":(297,578),u"CB03_08L":(730,681),u"CB03_08M":(394,595),u"CB03_08S":(297,578),u"CB03_09L":(730,681),u"CB03_09M":(394,595),u"CB03_09S":(297,578),u"CB03_10L":(730,681),u"CB03_10M":(394,595),u"CB03_10S":(297,578),u"CB03_11L":(730,681),u"CB03_11M":(394,595),u"CB03_11S":(297,578),u"CB03_12L":(730,681),u"CB03_12M":(394,595),u"CB03_12S":(297,578),u"CB03_13L":(885,688),u"CB03_13M":(460,599),u"CB03_13S":(348,580),u"CB04_01L":(730,681),u"CB04_01M":(394,595),u"CB04_01S":(297,578),u"CB04_02L":(885,688),u"CB04_02M":(460,599),u"CB04_02S":(348,580),u"CB04_03L":(885,688),u"CB04_03M":(460,599),u"CB04_03S":(348,580),u"CB04_04L":(885,688),u"CB04_04M":(460,599),u"CB04_04S":(348,580),u"CB04_05L":(730,681),u"CB04_05M":(394,595),u"CB04_05S":(297,578),u"CB04_06L":(730,681),u"CB04_06M":(394,595),u"CB04_06S":(297,578),u"CB04_07L":(730,681),u"CB04_07M":(394,595),u"CB04_07S":(297,578),u"CB04_08L":(730,681),u"CB04_08M":(394,595),u"CB04_08S":(297,578),u"CB04_09L":(730,681),u"CB04_09M":(394,595),u"CB04_09S":(297,578),u"CB04_10L":(730,681),u"CB04_10M":(394,595),u"CB04_10S":(297,578),u"CB04_11L":(730,681),u"CB04_11M":(394,595),u"CB04_11S":(297,578),u"CB04_12L":(730,681),u"CB04_12M":(394,595),u"CB04_12S":(297,578),u"CB04_13L":(885,688),u"CB04_13M":(460,599),u"CB04_13S":(348,580),u"CB06_01L":(730,681),u"CB06_01M":(394,595),u"CB06_01S":(297,578),u"CB06_02L":(885,688),u"CB06_02M":(460,599),u"CB06_02S":(348,580),u"CB06_03L":(885,688),u"CB06_03M":(460,599),u"CB06_03S":(348,580),u"CB06_04L":(885,688),u"CB06_04M":(460,599),u"CB06_04S":(348,580),u"CB06_05L":(730,681),u"CB06_05M":(394,595),u"CB06_05S":(297,578),u"CB06_06L":(730,681),u"CB06_06M":(394,595),u"CB06_06S":(297,578),u"CB06_07L":(730,681),u"CB06_07M":(394,595),u"CB06_07S":(297,578),u"CB06_08L":(730,681),u"CB06_08M":(394,595),u"CB06_08S":(297,578),u"CB06_09L":(730,681),u"CB06_09M":(394,595),u"CB06_09S":(297,578),u"CB06_10L":(730,681),u"CB06_10M":(394,595),u"CB06_10S":(297,578),u"CB06_11L":(730,681),u"CB06_11M":(394,595),u"CB06_11S":(297,578),u"CB06_12L":(730,681),u"CB06_12M":(394,595),u"CB06_12S":(297,578),u"CB06_13L":(885,688),u"CB06_13M":(460,599),u"CB06_13S":(348,580),u"CB07_01L":(730,681),u"CB07_01M":(394,595),u"CB07_01S":(297,578),u"CB07_02L":(885,688),u"CB07_02M":(460,599),u"CB07_02S":(348,580),u"CB07_03L":(885,688),u"CB07_03M":(460,599),u"CB07_03S":(348,580),u"CB07_04L":(885,688),u"CB07_04M":(460,599),u"CB07_04S":(348,580),u"CB07_05L":(730,681),u"CB07_05M":(394,595),u"CB07_05S":(297,578),u"CB07_06L":(730,681),u"CB07_06M":(394,595),u"CB07_06S":(297,578),u"CB07_07L":(730,681),u"CB07_07M":(394,595),u"CB07_07S":(297,578),u"CB07_08L":(730,681),u"CB07_08M":(394,595),u"CB07_08S":(297,578),u"CB07_09L":(730,681),u"CB07_09M":(394,595),u"CB07_09S":(297,578),u"CB07_10L":(730,681),u"CB07_10M":(394,595),u"CB07_10S":(297,578),u"CB07_11L":(730,681),u"CB07_11M":(394,595),u"CB07_11S":(297,578),u"CB07_12L":(730,681),u"CB07_12M":(394,595),u"CB07_12S":(297,578),u"CB07_13L":(885,688),u"CB07_13M":(460,599),u"CB07_13S":(348,580),u"CC01_01L":(1076,706),u"CC01_02L":(1076,706),u"CC01_02M":(546,570),u"CC01_02S":(425,637),u"CC01_03L":(1076,706),u"CC01_03M":(546,570),u"CC01_03S":(425,637),u"CC01_04L":(1076,706),u"CC01_04M":(546,689),u"CC01_04S":(425,637),u"CC01_05L":(698,619),u"CC01_05M":(455,546),u"CC01_05S":(352,527),u"CC01_06L":(698,619),u"CC01_06M":(455,546),u"CC01_06S":(352,527),u"CC01_07L":(698,619),u"CC01_07M":(455,546),u"CC01_07S":(352,527),u"CC01_08L":(698,619),u"CC01_08M":(455,546),u"CC01_08S":(352,527),u"CC01_09L":(1076,706),u"CC01_09M":(546,570),u"CC01_09S":(425,637),u"CC01_10L":(1076,706),u"CC01_10M":(546,570),u"CC01_10S":(425,637),u"CC01_11L":(698,619),u"CC01_11M":(455,546),u"CC01_11S":(352,527),u"CC01_12L":(1076,706),u"CC01_12M":(546,570),u"CC01_12S":(425,637),u"CC01_13L":(1076,706),u"CC01_13M":(546,570),u"CC01_13S":(425,637),u"CC01_14L":(698,619),u"CC01_14M":(455,546),u"CC01_14S":(352,527),u"CC02_01L":(1076,706),u"CC02_01M":(546,570),u"CC02_01S":(425,637),u"CC02_02L":(1076,706),u"CC02_02M":(546,570),u"CC02_02S":(425,637),u"CC02_03L":(1076,706),u"CC02_03M":(546,570),u"CC02_03S":(425,637),u"CC02_04L":(1076,706),u"CC02_04M":(546,689),u"CC02_04S":(425,637),u"CC02_05L":(698,619),u"CC02_05M":(455,546),u"CC02_05S":(352,527),u"CC02_06L":(698,619),u"CC02_06M":(455,546),u"CC02_06S":(352,527),u"CC02_07L":(698,619),u"CC02_07M":(455,546),u"CC02_07S":(352,527),u"CC02_08L":(698,619),u"CC02_08M":(455,546),u"CC02_08S":(352,527),u"CC02_09L":(1076,706),u"CC02_09M":(546,570),u"CC02_09S":(425,637),u"CC02_10L":(1076,706),u"CC02_10M":(546,570),u"CC02_10S":(425,637),u"CC02_11L":(698,619),u"CC02_11M":(455,546),u"CC02_11S":(352,527),u"CC02_12L":(1076,706),u"CC02_12M":(546,570),u"CC02_12S":(425,637),u"CC02_13L":(1076,706),u"CC02_13M":(546,570),u"CC02_13S":(425,637),u"CC02_14L":(698,619),u"CC02_14M":(455,546),u"CC02_14S":(352,527),u"CC03_01L":(1076,706),u"CC03_01M":(1132,570),u"CC03_01S":(923,637),u"CC03_02L":(1076,706),u"CC03_02M":(1132,570),u"CC03_02S":(923,637),u"CC03_03L":(1076,706),u"CC03_03M":(1132,570),u"CC03_03S":(923,637),u"CC03_04L":(1076,706),u"CC03_04M":(1132,689),u"CC03_04S":(923,637),u"CC03_05L":(698,619),u"CC03_05M":(1023,546),u"CC03_05S":(701,527),u"CC03_06L":(698,619),u"CC03_06M":(1023,546),u"CC03_06S":(701,527),u"CC03_07L":(698,619),u"CC03_07M":(1023,546),u"CC03_07S":(701,527),u"CC03_08L":(698,619),u"CC03_08M":(1023,546),u"CC03_08S":(701,527),u"CC03_09L":(1076,706),u"CC03_09M":(1132,570),u"CC03_09S":(923,637),u"CC03_10L":(1076,706),u"CC03_10M":(1132,570),u"CC03_10S":(923,637),u"CC03_11L":(698,619),u"CC03_11M":(1023,546),u"CC03_11S":(701,527),u"CC03_12L":(1076,706),u"CC03_12M":(1132,570),u"CC03_12S":(923,637),u"CC03_13L":(1076,706),u"CC03_13M":(1132,570),u"CC03_13S":(923,637),u"CC03_14L":(698,619),u"CC03_14M":(1023,546),u"CC03_14S":(701,527),u"CC04_01L":(1076,706),u"CC04_01M":(546,570),u"CC04_01S":(425,637),u"CC04_02L":(1076,706),u"CC04_02M":(546,570),u"CC04_02S":(425,637),u"CC04_03L":(1076,706),u"CC04_03M":(546,570),u"CC04_03S":(425,637),u"CC04_04L":(1076,706),u"CC04_04M":(546,689),u"CC04_04S":(425,637),u"CC04_05L":(698,619),u"CC04_05M":(455,546),u"CC04_05S":(352,527),u"CC04_06L":(698,619),u"CC04_06M":(455,546),u"CC04_06S":(352,527),u"CC04_07L":(698,619),u"CC04_07M":(455,546),u"CC04_07S":(352,527),u"CC04_08L":(698,619),u"CC04_08M":(455,546),u"CC04_08S":(352,527),u"CC04_09L":(1076,706),u"CC04_09M":(546,570),u"CC04_09S":(425,637),u"CC04_10L":(1076,706),u"CC04_10M":(546,570),u"CC04_10S":(425,637),u"CC04_11L":(698,619),u"CC04_11M":(455,546),u"CC04_11S":(352,527),u"CC04_12L":(1076,706),u"CC04_12M":(546,570),u"CC04_12S":(425,637),u"CC04_13L":(1076,706),u"CC04_13M":(546,570),u"CC04_13S":(425,637),u"CC04_14L":(698,619),u"CC04_14M":(455,546),u"CC04_14S":(352,527),u"CC05_01L":(1076,706),u"CC05_01M":(546,570),u"CC05_01S":(425,637),u"CC05_02L":(1076,706),u"CC05_02M":(546,570),u"CC05_02S":(425,637),u"CC05_03L":(1076,706),u"CC05_03M":(546,570),u"CC05_03S":(425,637),u"CC05_04L":(1076,706),u"CC05_04M":(546,689),u"CC05_04S":(425,637),u"CC05_05L":(698,619),u"CC05_05M":(455,546),u"CC05_05S":(352,527),u"CC05_06L":(698,619),u"CC05_06M":(455,546),u"CC05_06S":(352,527),u"CC05_07L":(698,619),u"CC05_07M":(455,546),u"CC05_07S":(352,527),u"CC05_08L":(698,619),u"CC05_08M":(455,546),u"CC05_08S":(352,527),u"CC05_09L":(1076,706),u"CC05_09M":(546,570),u"CC05_09S":(425,637),u"CC05_10L":(1076,706),u"CC05_10M":(546,570),u"CC05_10S":(425,637),u"CC05_11L":(698,619),u"CC05_11M":(455,546),u"CC05_11S":(352,527),u"CC05_12L":(1076,706),u"CC05_12M":(546,570),u"CC05_12S":(425,637),u"CC05_13L":(1076,706),u"CC05_13M":(546,570),u"CC05_13S":(425,637),u"CC05_14L":(698,619),u"CC05_14M":(455,546),u"CC05_14S":(352,527),u"CC06_01L":(1076,706),u"CC06_01M":(546,570),u"CC06_01S":(425,637),u"CC06_02L":(1076,706),u"CC06_02M":(546,570),u"CC06_02S":(425,637),u"CC06_03L":(1076,706),u"CC06_03M":(546,570),u"CC06_03S":(425,637),u"CC06_04L":(1076,706),u"CC06_04M":(546,689),u"CC06_04S":(425,637),u"CC06_05L":(698,619),u"CC06_05M":(455,546),u"CC06_05S":(352,527),u"CC06_06L":(698,619),u"CC06_06M":(455,546),u"CC06_06S":(352,527),u"CC06_07L":(698,619),u"CC06_07M":(455,546),u"CC06_07S":(352,527),u"CC06_08L":(698,619),u"CC06_08M":(455,546),u"CC06_08S":(352,527),u"CC06_09L":(1076,706),u"CC06_09M":(546,570),u"CC06_09S":(425,637),u"CC06_10L":(1076,706),u"CC06_10M":(546,570),u"CC06_10S":(425,637),u"CC06_11L":(698,619),u"CC06_11M":(455,546),u"CC06_11S":(352,527),u"CC06_12L":(1076,706),u"CC06_12M":(546,570),u"CC06_12S":(425,637),u"CC06_13L":(1076,706),u"CC06_13M":(546,570),u"CC06_13S":(425,637),u"CC06_14L":(698,619),u"CC06_14M":(455,546),u"CC06_14S":(352,527),u"CC07_01L":(1076,706),u"CC07_01M":(546,570),u"CC07_01S":(425,637),u"CC07_02L":(1076,706),u"CC07_02M":(546,570),u"CC07_02S":(425,637),u"CC07_03L":(1076,706),u"CC07_03M":(546,570),u"CC07_03S":(425,637),u"CC07_04L":(1076,706),u"CC07_04M":(546,689),u"CC07_04S":(425,637),u"CC07_05L":(698,619),u"CC07_05M":(455,546),u"CC07_05S":(352,527),u"CC07_06L":(698,619),u"CC07_06M":(455,546),u"CC07_06S":(352,527),u"CC07_07L":(698,619),u"CC07_07M":(455,546),u"CC07_07S":(352,527),u"CC07_08L":(698,619),u"CC07_08M":(455,546),u"CC07_08S":(352,527),u"CC07_09L":(1076,706),u"CC07_09M":(546,570),u"CC07_09S":(425,637),u"CC07_10L":(1076,706),u"CC07_10M":(546,570),u"CC07_10S":(425,637),u"CC07_11L":(698,619),u"CC07_11M":(455,546),u"CC07_11S":(352,527),u"CC07_12L":(1076,706),u"CC07_12M":(546,570),u"CC07_12S":(425,637),u"CC07_13L":(1076,706),u"CC07_13M":(546,570),u"CC07_13S":(425,637),u"CC07_14L":(698,619),u"CC07_14M":(455,546),u"CC07_14S":(352,527),u"CC08_01L":(1076,706),u"CC08_01M":(546,570),u"CC08_01S":(425,637),u"CC08_02L":(1076,706),u"CC08_02M":(546,570),u"CC08_02S":(425,637),u"CC08_03L":(1076,706),u"CC08_03M":(546,570),u"CC08_03S":(425,637),u"CC08_04L":(1076,706),u"CC08_04M":(546,689),u"CC08_04S":(425,637),u"CC08_05L":(698,619),u"CC08_05M":(455,546),u"CC08_05S":(352,527),u"CC08_06L":(698,619),u"CC08_06M":(455,546),u"CC08_06S":(352,527),u"CC08_07L":(698,619),u"CC08_07M":(455,546),u"CC08_07S":(352,527),u"CC08_08L":(698,619),u"CC08_08M":(455,546),u"CC08_08S":(352,527),u"CC08_09L":(1076,706),u"CC08_09M":(546,570),u"CC08_09S":(425,637),u"CC08_10L":(1076,706),u"CC08_10M":(546,570),u"CC08_10S":(425,637),u"CC08_11L":(698,619),u"CC08_11M":(455,546),u"CC08_11S":(352,527),u"CC08_12L":(1076,706),u"CC08_12M":(546,570),u"CC08_12S":(425,637),u"CC08_13L":(1076,706),u"CC08_13M":(546,570),u"CC08_13S":(425,637),u"CC08_14L":(698,619),u"CC08_14M":(455,546),u"CC08_14S":(352,527),u"CD01_01L":(941,681),u"CD01_01M":(533,590),u"CD01_01S":(405,579),u"CD01_02L":(637,681),u"CD01_02M":(349,590),u"CD01_02S":(306,579),u"CD01_03L":(637,681),u"CD01_03M":(349,590),u"CD01_03S":(306,579),u"CD01_04L":(941,681),u"CD01_04M":(533,590),u"CD01_04S":(405,579),u"CD01_05L":(637,681),u"CD01_05M":(349,590),u"CD01_05S":(306,579),u"CD01_06L":(941,681),u"CD01_06M":(533,590),u"CD01_06S":(405,579),u"CD01_07L":(637,681),u"CD01_07M":(349,590),u"CD01_07S":(306,579),u"CD01_08L":(941,681),u"CD01_08M":(533,590),u"CD01_08S":(405,579),u"CD01_09L":(637,681),u"CD01_09M":(349,590),u"CD01_09S":(306,579),u"CD01_10L":(941,681),u"CD01_10M":(533,590),u"CD01_10S":(405,579),u"CD01_11L":(637,681),u"CD01_11M":(349,590),u"CD01_11S":(306,579),u"CD01_12L":(941,681),u"CD01_12M":(533,590),u"CD01_12S":(405,579),u"CD01_13L":(941,681),u"CD01_13M":(533,590),u"CD01_13S":(405,579),u"CD02_01L":(941,681),u"CD02_01M":(533,590),u"CD02_01S":(405,579),u"CD02_02L":(637,681),u"CD02_02M":(349,590),u"CD02_02S":(306,579),u"CD02_03L":(637,681),u"CD02_03M":(349,590),u"CD02_03S":(306,579),u"CD02_04L":(941,681),u"CD02_04M":(533,590),u"CD02_04S":(405,579),u"CD02_05L":(637,681),u"CD02_05M":(349,590),u"CD02_05S":(306,579),u"CD02_06L":(941,681),u"CD02_06M":(533,590),u"CD02_06S":(405,579),u"CD02_07L":(637,681),u"CD02_07M":(349,590),u"CD02_07S":(306,579),u"CD02_08L":(941,681),u"CD02_08M":(533,590),u"CD02_08S":(405,579),u"CD02_09L":(637,681),u"CD02_09M":(349,590),u"CD02_09S":(306,579),u"CD02_10L":(941,681),u"CD02_10M":(533,590),u"CD02_10S":(405,579),u"CD02_11L":(637,681),u"CD02_11M":(349,590),u"CD02_11S":(306,579),u"CD02_12L":(941,681),u"CD02_12M":(533,590),u"CD02_12S":(405,579),u"CD02_13L":(941,681),u"CD02_13M":(533,590),u"CD02_13S":(405,579),u"CD03_01L":(941,681),u"CD03_01M":(533,590),u"CD03_01S":(405,579),u"CD03_02L":(637,681),u"CD03_02M":(349,590),u"CD03_02S":(306,579),u"CD03_03L":(637,681),u"CD03_03M":(349,590),u"CD03_03S":(306,579),u"CD03_04L":(941,681),u"CD03_04M":(533,590),u"CD03_04S":(405,579),u"CD03_05L":(637,681),u"CD03_05M":(349,590),u"CD03_05S":(306,579),u"CD03_06L":(941,681),u"CD03_06M":(533,590),u"CD03_06S":(405,579),u"CD03_07L":(637,681),u"CD03_07M":(349,590),u"CD03_07S":(306,579),u"CD03_08L":(941,681),u"CD03_08M":(533,590),u"CD03_08S":(405,579),u"CD03_09L":(637,681),u"CD03_09M":(349,590),u"CD03_09S":(306,579),u"CD03_10L":(941,681),u"CD03_10M":(533,590),u"CD03_10S":(405,579),u"CD03_11L":(637,681),u"CD03_11M":(349,590),u"CD03_11S":(306,579),u"CD03_12L":(941,681),u"CD03_12M":(533,590),u"CD03_12S":(405,579),u"CD03_13L":(941,681),u"CD03_13M":(533,590),u"CD03_13S":(405,579),u"CD04_01L":(941,681),u"CD04_01M":(533,590),u"CD04_01S":(405,579),u"CD04_02L":(637,681),u"CD04_02M":(349,590),u"CD04_02S":(306,579),u"CD04_03L":(637,681),u"CD04_03M":(349,590),u"CD04_03S":(306,579),u"CD04_04L":(941,681),u"CD04_04M":(533,590),u"CD04_04S":(405,579),u"CD04_05L":(637,681),u"CD04_05M":(349,590),u"CD04_05S":(306,579),u"CD04_06L":(941,681),u"CD04_06M":(533,590),u"CD04_06S":(405,579),u"CD04_07L":(637,681),u"CD04_07M":(349,590),u"CD04_07S":(306,579),u"CD04_08L":(941,681),u"CD04_08M":(533,590),u"CD04_08S":(405,579),u"CD04_09L":(637,681),u"CD04_09M":(349,590),u"CD04_09S":(306,579),u"CD04_10L":(941,681),u"CD04_10M":(533,590),u"CD04_10S":(405,579),u"CD04_11L":(637,681),u"CD04_11M":(349,590),u"CD04_11S":(306,579),u"CD04_12L":(941,681),u"CD04_12M":(533,590),u"CD04_12S":(405,579),u"CD04_13L":(941,681),u"CD04_13M":(533,590),u"CD04_13S":(405,579),u"CD05_01L":(941,681),u"CD05_01M":(533,590),u"CD05_01S":(405,579),u"CD05_02L":(637,681),u"CD05_02M":(349,590),u"CD05_02S":(306,579),u"CD05_03L":(637,681),u"CD05_03M":(349,590),u"CD05_03S":(306,579),u"CD05_04L":(941,681),u"CD05_04M":(533,590),u"CD05_04S":(405,579),u"CD05_05L":(637,681),u"CD05_05M":(349,590),u"CD05_05S":(306,579),u"CD05_06L":(941,681),u"CD05_06M":(533,590),u"CD05_06S":(405,579),u"CD05_07L":(637,681),u"CD05_07M":(349,590),u"CD05_07S":(306,579),u"CD05_08L":(941,681),u"CD05_08M":(533,590),u"CD05_08S":(405,579),u"CD05_09L":(637,681),u"CD05_09M":(349,590),u"CD05_09S":(306,579),u"CD05_10L":(941,681),u"CD05_10M":(533,590),u"CD05_10S":(405,579),u"CD05_11L":(637,681),u"CD05_11M":(349,590),u"CD05_11S":(306,579),u"CD05_12L":(941,681),u"CD05_12M":(533,590),u"CD05_12S":(405,579),u"CD05_13L":(941,681),u"CD05_13M":(533,590),u"CD05_13S":(405,579),u"CD06_01L":(941,681),u"CD06_01M":(533,590),u"CD06_01S":(405,579),u"CD06_02L":(637,681),u"CD06_02M":(349,590),u"CD06_02S":(306,579),u"CD06_03L":(637,681),u"CD06_03M":(349,590),u"CD06_03S":(306,579),u"CD06_04L":(941,681),u"CD06_04M":(533,590),u"CD06_04S":(405,579),u"CD06_05L":(637,681),u"CD06_05M":(349,590),u"CD06_05S":(306,579),u"CD06_06L":(941,681),u"CD06_06M":(533,590),u"CD06_06S":(405,579),u"CD06_07L":(637,681),u"CD06_07M":(349,590),u"CD06_07S":(306,579),u"CD06_08L":(941,681),u"CD06_08M":(533,590),u"CD06_08S":(405,579),u"CD06_09L":(637,681),u"CD06_09M":(349,590),u"CD06_09S":(306,579),u"CD06_10L":(941,681),u"CD06_10M":(533,590),u"CD06_10S":(405,579),u"CD06_11L":(637,681),u"CD06_11M":(349,590),u"CD06_11S":(306,579),u"CD06_12L":(941,681),u"CD06_12M":(533,590),u"CD06_12S":(405,579),u"CD06_13L":(941,681),u"CD06_13M":(533,590),u"CD06_13S":(405,579),u"CD07_01L":(941,681),u"CD07_01M":(533,590),u"CD07_01S":(405,579),u"CD07_02L":(637,681),u"CD07_02M":(349,590),u"CD07_02S":(306,579),u"CD07_03L":(637,681),u"CD07_03M":(349,590),u"CD07_03S":(306,579),u"CD07_04L":(941,681),u"CD07_04M":(533,590),u"CD07_04S":(405,579),u"CD07_05L":(637,681),u"CD07_05M":(349,590),u"CD07_05S":(306,579),u"CD07_06L":(941,681),u"CD07_06M":(533,590),u"CD07_06S":(405,579),u"CD07_07L":(637,681),u"CD07_07M":(349,590),u"CD07_07S":(306,579),u"CD07_08L":(941,681),u"CD07_08M":(533,590),u"CD07_08S":(405,579),u"CD07_09L":(637,681),u"CD07_09M":(349,590),u"CD07_09S":(306,579),u"CD07_10L":(941,681),u"CD07_10M":(533,590),u"CD07_10S":(405,579),u"CD07_11L":(637,681),u"CD07_11M":(349,590),u"CD07_11S":(306,579),u"CD07_12L":(941,681),u"CD07_12M":(533,590),u"CD07_12S":(405,579),u"CD07_13L":(941,681),u"CD07_13M":(533,590),u"CD07_13S":(405,579),u"CE01_01L":(586,706),u"CE01_01M":(353,608),u"CE01_01S":(388,581),u"CE01_02L":(586,698),u"CE01_02M":(403,603),u"CE01_02S":(390,581),u"CE01_03L":(586,706),u"CE01_03M":(353,608),u"CE01_03S":(388,581),u"CE01_04L":(586,698),u"CE01_04M":(403,603),u"CE01_04S":(390,581),u"CE01_05L":(586,706),u"CE01_05M":(353,608),u"CE01_05S":(388,581),u"CE01_06L":(586,706),u"CE01_06M":(353,608),u"CE01_06S":(388,581),u"CE01_07L":(586,698),u"CE01_07M":(403,603),u"CE01_07S":(390,581),u"CE01_08L":(586,706),u"CE01_08M":(353,608),u"CE01_08S":(388,581),u"CE01_09L":(586,706),u"CE01_09M":(353,608),u"CE01_09S":(388,581),u"CE01_10L":(586,698),u"CE01_10M":(403,603),u"CE01_10S":(390,581),u"CE01_11L":(586,698),u"CE01_11M":(403,603),u"CE01_11S":(390,581),u"CE01_12L":(586,706),u"CE01_12M":(353,608),u"CE01_12S":(388,581),u"CE02_01L":(586,706),u"CE02_01M":(353,608),u"CE02_01S":(388,581),u"CE02_02L":(586,698),u"CE02_02M":(403,603),u"CE02_02S":(390,581),u"CE02_03L":(586,706),u"CE02_03M":(353,608),u"CE02_03S":(388,581),u"CE02_04L":(586,698),u"CE02_04M":(403,603),u"CE02_04S":(390,581),u"CE02_05L":(586,706),u"CE02_05M":(353,608),u"CE02_05S":(388,581),u"CE02_06L":(586,706),u"CE02_06M":(353,608),u"CE02_06S":(388,581),u"CE02_07L":(586,698),u"CE02_07M":(403,603),u"CE02_07S":(390,581),u"CE02_08L":(586,706),u"CE02_08M":(353,608),u"CE02_08S":(388,581),u"CE02_09L":(586,706),u"CE02_09M":(353,608),u"CE02_09S":(388,581),u"CE02_10L":(586,698),u"CE02_10M":(403,603),u"CE02_10S":(390,581),u"CE02_11L":(586,698),u"CE02_11M":(403,603),u"CE02_11S":(390,581),u"CE02_12L":(586,706),u"CE02_12M":(353,608),u"CE02_12S":(388,581),u"CE03_01L":(586,706),u"CE03_01M":(353,608),u"CE03_01S":(388,581),u"CE03_02L":(586,698),u"CE03_02M":(403,603),u"CE03_02S":(390,581),u"CE03_03L":(586,706),u"CE03_03M":(353,608),u"CE03_03S":(388,581),u"CE03_04L":(586,698),u"CE03_04M":(403,603),u"CE03_04S":(390,581),u"CE03_05L":(586,706),u"CE03_05M":(353,608),u"CE03_05S":(388,581),u"CE03_06L":(586,706),u"CE03_06M":(353,608),u"CE03_06S":(388,581),u"CE03_07L":(586,698),u"CE03_07M":(403,603),u"CE03_07S":(390,581),u"CE03_08L":(586,706),u"CE03_08M":(353,608),u"CE03_08S":(388,581),u"CE03_09L":(586,706),u"CE03_09M":(353,608),u"CE03_09S":(388,581),u"CE03_10L":(586,698),u"CE03_10M":(403,603),u"CE03_10S":(390,581),u"CE03_11L":(586,698),u"CE03_11M":(403,603),u"CE03_11S":(390,581),u"CE03_12L":(586,706),u"CE03_12M":(353,608),u"CE03_12S":(388,581),u"CE04_01L":(586,706),u"CE04_01M":(353,608),u"CE04_01S":(388,581),u"CE04_02L":(586,698),u"CE04_02M":(403,603),u"CE04_02S":(390,581),u"CE04_03L":(586,706),u"CE04_03M":(353,608),u"CE04_03S":(388,581),u"CE04_04L":(586,698),u"CE04_04M":(403,603),u"CE04_04S":(390,581),u"CE04_05L":(586,706),u"CE04_05M":(353,608),u"CE04_05S":(388,581),u"CE04_06L":(586,706),u"CE04_06M":(353,608),u"CE04_06S":(388,581),u"CE04_07L":(586,698),u"CE04_07M":(403,603),u"CE04_07S":(390,581),u"CE04_08L":(586,706),u"CE04_08M":(353,608),u"CE04_08S":(388,581),u"CE04_09L":(586,706),u"CE04_09M":(353,608),u"CE04_09S":(388,581),u"CE04_10L":(586,698),u"CE04_10M":(403,603),u"CE04_10S":(390,581),u"CE04_11L":(586,698),u"CE04_11M":(403,603),u"CE04_11S":(390,581),u"CE04_12L":(586,706),u"CE04_12M":(353,608),u"CE04_12S":(388,581),u"CF01_01L":(886,701),u"CF01_01M":(485,659),u"CF01_01S":(366,645),u"CF01_02L":(886,701),u"CF01_02M":(485,659),u"CF01_02S":(366,645),u"CF01_03L":(886,701),u"CF01_03M":(485,659),u"CF01_03S":(366,645),u"CF01_04L":(886,701),u"CF01_04M":(485,659),u"CF01_04S":(366,645),u"CF01_05L":(1014,723),u"CF01_05M":(559,672),u"CF01_05S":(423,654),u"CF01_06L":(1014,723),u"CF01_06M":(559,672),u"CF01_06S":(423,654),u"CF01_07L":(886,701),u"CF01_07M":(485,659),u"CF01_07S":(366,645),u"CF01_08L":(886,701),u"CF01_08M":(485,659),u"CF01_08S":(366,645),u"CF01_09L":(1014,723),u"CF01_09M":(559,672),u"CF01_09S":(423,654),u"CF01_10L":(1014,723),u"CF01_10M":(559,672),u"CF01_10S":(423,654),u"CF02_01L":(886,701),u"CF02_01M":(485,659),u"CF02_01S":(366,645),u"CF02_02L":(886,701),u"CF02_02M":(485,659),u"CF02_02S":(366,645),u"CF02_03L":(886,701),u"CF02_03M":(485,659),u"CF02_03S":(366,645),u"CF02_04L":(886,701),u"CF02_04M":(485,659),u"CF02_04S":(366,645),u"CF02_05L":(1014,723),u"CF02_05M":(559,672),u"CF02_05S":(423,654),u"CF02_06L":(1014,723),u"CF02_06M":(559,672),u"CF02_06S":(423,654),u"CF02_07L":(886,701),u"CF02_07M":(485,659),u"CF02_07S":(366,645),u"CF02_08L":(886,701),u"CF02_08M":(485,659),u"CF02_08S":(366,645),u"CF02_09L":(1014,723),u"CF02_09M":(559,672),u"CF02_09S":(423,654),u"CF02_10L":(1014,723),u"CF02_10M":(559,672),u"CF02_10S":(423,654),u"CF03_01L":(886,701),u"CF03_01M":(485,659),u"CF03_01S":(366,645),u"CF03_02L":(886,701),u"CF03_02M":(485,659),u"CF03_02S":(366,645),u"CF03_03L":(886,701),u"CF03_03M":(485,659),u"CF03_03S":(366,645),u"CF03_04L":(886,701),u"CF03_04M":(485,659),u"CF03_04S":(366,645),u"CF03_05L":(1014,723),u"CF03_05M":(559,672),u"CF03_05S":(423,654),u"CF03_06L":(1014,723),u"CF03_06M":(559,672),u"CF03_06S":(423,654),u"CF03_07L":(886,701),u"CF03_07M":(485,659),u"CF03_07S":(366,645),u"CF03_08L":(886,701),u"CF03_08M":(485,659),u"CF03_08S":(366,645),u"CF03_09L":(1014,723),u"CF03_09M":(559,672),u"CF03_09S":(423,654),u"CF03_10L":(1014,723),u"CF03_10M":(559,672),u"CF03_10S":(423,654),u"CF04_01L":(886,701),u"CF04_01M":(485,659),u"CF04_01S":(366,645),u"CF04_02L":(886,701),u"CF04_02M":(485,659),u"CF04_02S":(366,645),u"CF04_03L":(886,701),u"CF04_03M":(485,659),u"CF04_03S":(366,645),u"CF04_04L":(886,701),u"CF04_04M":(485,659),u"CF04_04S":(366,645),u"CF04_05L":(1014,723),u"CF04_05M":(559,672),u"CF04_05S":(423,654),u"CF04_06L":(1014,723),u"CF04_06M":(559,672),u"CF04_06S":(423,654),u"CF04_07L":(886,701),u"CF04_07M":(485,659),u"CF04_07S":(366,645),u"CF04_08L":(886,701),u"CF04_08M":(485,659),u"CF04_08S":(366,645),u"CF04_09L":(1014,723),u"CF04_09M":(559,672),u"CF04_09S":(423,654),u"CF04_10L":(1014,723),u"CF04_10M":(559,672),u"CF04_10S":(423,654),u"CF05_01L":(886,701),u"CF05_01M":(485,659),u"CF05_01S":(366,645),u"CF05_02L":(886,701),u"CF05_02M":(485,659),u"CF05_02S":(366,645),u"CF05_03L":(886,701),u"CF05_03M":(485,659),u"CF05_03S":(366,645),u"CF05_04L":(886,701),u"CF05_04M":(485,659),u"CF05_04S":(366,645),u"CF05_05L":(1014,723),u"CF05_05M":(559,672),u"CF05_05S":(423,654),u"CF05_06L":(1014,723),u"CF05_06M":(559,672),u"CF05_06S":(423,654),u"CF05_07L":(886,701),u"CF05_07M":(485,659),u"CF05_07S":(366,645),u"CF05_08L":(886,701),u"CF05_08M":(485,659),u"CF05_08S":(366,645),u"CF05_09L":(1014,723),u"CF05_09M":(559,672),u"CF05_09S":(423,654),u"CF05_10L":(1014,723),u"CF05_10M":(559,672),u"CF05_10S":(423,654),u"CF06_01L":(886,701),u"CF06_01M":(485,659),u"CF06_01S":(366,645),u"CF06_02L":(886,701),u"CF06_02M":(485,659),u"CF06_02S":(366,645),u"CF06_03L":(886,701),u"CF06_03M":(485,659),u"CF06_03S":(366,645),u"CF06_04L":(886,701),u"CF06_04M":(485,659),u"CF06_04S":(366,645),u"CF06_05L":(1014,723),u"CF06_05M":(559,672),u"CF06_05S":(423,654),u"CF06_06L":(1014,723),u"CF06_06M":(559,672),u"CF06_06S":(423,654),u"CF06_07L":(886,701),u"CF06_07M":(485,659),u"CF06_07S":(366,645),u"CF06_08L":(886,701),u"CF06_08M":(485,659),u"CF06_08S":(366,645),u"CF06_09L":(1014,723),u"CF06_09M":(559,672),u"CF06_09S":(423,654),u"CF06_10L":(1014,723),u"CF06_10M":(559,672),u"CF06_10S":(423,654),u"CG01_01L":(958,729),u"CG01_01M":(457,618),u"CG01_01S":(346,600),u"CG01_02L":(958,729),u"CG01_02M":(457,618),u"CG01_02S":(346,600),u"CG01_03L":(958,729),u"CG01_03M":(457,618),u"CG01_03S":(346,600),u"CG01_04L":(958,729),u"CG01_04M":(457,618),u"CG01_04S":(346,600),u"CG01_05L":(958,729),u"CG01_05M":(457,618),u"CG01_05S":(346,600),u"CG01_06L":(958,729),u"CG01_06M":(457,618),u"CG01_06S":(346,600),u"CG01_07L":(958,729),u"CG01_07M":(457,618),u"CG01_07S":(346,600),u"CG01_08L":(958,729),u"CG01_08M":(457,618),u"CG01_08S":(346,600),u"CG02_01L":(958,697),u"CG02_01M":(457,601),u"CG02_01S":(346,587),u"CG02_02L":(958,697),u"CG02_02M":(457,601),u"CG02_02S":(346,587),u"CG02_03L":(958,697),u"CG02_03M":(457,601),u"CG02_03S":(346,587),u"CG02_04L":(958,697),u"CG02_04M":(457,601),u"CG02_04S":(346,587),u"CG02_05L":(958,697),u"CG02_05M":(457,601),u"CG02_05S":(346,587),u"CG02_06L":(958,697),u"CG02_06M":(457,601),u"CG02_06S":(346,587),u"CG02_07L":(958,697),u"CG02_07M":(457,601),u"CG02_07S":(346,587),u"CG02_08L":(958,697),u"CG02_08M":(457,601),u"CG02_08S":(346,587),u"CG03_01L":(958,688),u"CG03_01M":(457,596),u"CG03_01S":(346,583),u"CG03_02L":(958,688),u"CG03_02M":(457,596),u"CG03_02S":(346,583),u"CG03_03L":(958,688),u"CG03_03M":(457,596),u"CG03_03S":(346,583),u"CG03_04L":(958,688),u"CG03_04M":(457,596),u"CG03_04S":(346,583),u"CG03_05L":(958,688),u"CG03_05M":(457,596),u"CG03_05S":(346,583),u"CG03_06L":(958,688),u"CG03_06M":(457,596),u"CG03_06S":(346,583),u"CG03_07L":(958,688),u"CG03_07M":(457,596),u"CG03_07S":(346,583),u"CG03_08L":(958,688),u"CG03_08M":(457,596),u"CG03_08S":(346,583),u"CH01_01L":(694,651),u"CH01_01M":(337,569),u"CH01_01S":(276,553),u"CH01_02L":(694,651),u"CH01_02M":(337,569),u"CH01_02S":(276,553),u"CH01_03L":(694,651),u"CH01_03M":(337,569),u"CH01_03S":(276,553),u"CH01_04L":(694,651),u"CH01_04M":(337,569),u"CH01_04S":(276,553),u"CH01_05L":(694,651),u"CH01_05M":(337,569),u"CH01_05S":(276,553),u"CH01_06L":(694,651),u"CH01_06M":(337,569),u"CH01_06S":(276,553),u"CH01_07L":(694,651),u"CH01_07M":(337,569),u"CH01_07S":(276,553),u"CH01_08L":(694,651),u"CH01_08M":(337,569),u"CH01_08S":(276,553),u"CH01_09L":(694,651),u"CH01_09M":(337,569),u"CH01_09S":(276,553),u"CH01_10L":(694,651),u"CH01_10M":(337,569),u"CH01_10S":(276,553),u"CH01_11L":(694,651),u"CH01_11M":(337,569),u"CH01_11S":(276,553),u"CH02_01L":(694,651),u"CH02_01M":(337,569),u"CH02_01S":(276,553),u"CH02_02L":(694,651),u"CH02_02M":(337,569),u"CH02_02S":(276,553),u"CH02_03L":(694,651),u"CH02_03M":(337,569),u"CH02_03S":(276,553),u"CH02_04L":(694,651),u"CH02_04M":(337,569),u"CH02_04S":(276,553),u"CH02_05L":(694,651),u"CH02_05M":(337,569),u"CH02_05S":(276,553),u"CH02_06L":(694,651),u"CH02_06M":(337,569),u"CH02_06S":(276,553),u"CH02_07L":(694,651),u"CH02_07M":(337,569),u"CH02_07S":(276,553),u"CH02_08L":(694,651),u"CH02_08M":(337,569),u"CH02_08S":(276,553),u"CH02_09L":(694,651),u"CH02_09M":(337,569),u"CH02_09S":(276,553),u"CH02_10L":(694,651),u"CH02_10M":(337,569),u"CH02_10S":(276,553),u"CH02_11L":(694,651),u"CH02_11M":(337,569),u"CH02_11S":(276,553),u"CH04_01L":(694,651),u"CH04_01M":(337,569),u"CH04_01S":(276,553),u"CH04_02L":(694,651),u"CH04_02M":(337,569),u"CH04_02S":(276,553),u"CH04_03L":(694,651),u"CH04_03M":(337,569),u"CH04_03S":(276,553),u"CH04_04L":(694,651),u"CH04_04M":(337,569),u"CH04_04S":(276,553),u"CH04_05L":(694,651),u"CH04_05M":(337,569),u"CH04_05S":(276,553),u"CH04_06L":(694,651),u"CH04_06M":(337,569),u"CH04_06S":(276,553),u"CH04_07L":(694,651),u"CH04_07M":(337,569),u"CH04_07S":(276,553),u"CH04_08L":(694,651),u"CH04_08M":(337,569),u"CH04_08S":(276,553),u"CH04_09L":(694,651),u"CH04_09M":(337,569),u"CH04_09S":(276,553),u"CH04_10L":(694,651),u"CH04_10M":(337,569),u"CH04_10S":(276,553),u"CH04_11L":(694,651),u"CH04_11M":(337,569),u"CH04_11S":(276,553),u"CH05_01L":(694,651),u"CH05_01M":(337,569),u"CH05_01S":(276,553),u"CH05_02L":(694,651),u"CH05_02M":(337,569),u"CH05_02S":(276,553),u"CH05_03L":(694,651),u"CH05_03M":(337,569),u"CH05_03S":(276,553),u"CH05_04L":(694,651),u"CH05_04M":(337,569),u"CH05_04S":(276,553),u"CH05_05L":(694,651),u"CH05_05M":(337,569),u"CH05_05S":(276,553),u"CH05_06L":(694,651),u"CH05_06M":(337,569),u"CH05_06S":(276,553),u"CH05_07L":(694,651),u"CH05_07M":(337,569),u"CH05_07S":(276,553),u"CH05_08L":(694,651),u"CH05_08M":(337,569),u"CH05_08S":(276,553),u"CH05_09L":(694,651),u"CH05_09M":(337,569),u"CH05_09S":(276,553),u"CH05_10L":(694,651),u"CH05_10M":(337,569),u"CH05_10S":(276,553),u"CH05_11L":(694,651),u"CH05_11M":(337,569),u"CH05_11S":(276,553),u"CH06_01L":(694,651),u"CH06_01M":(337,569),u"CH06_01S":(276,553),u"CH06_02L":(694,651),u"CH06_02M":(337,569),u"CH06_02S":(276,553),u"CH06_03L":(694,651),u"CH06_03M":(337,569),u"CH06_03S":(276,553),u"CH06_04L":(694,651),u"CH06_04M":(337,569),u"CH06_04S":(276,553),u"CH06_05L":(694,651),u"CH06_05M":(337,569),u"CH06_05S":(276,553),u"CH06_06L":(694,651),u"CH06_06M":(337,569),u"CH06_06S":(276,553),u"CH06_07L":(694,651),u"CH06_07M":(337,569),u"CH06_07S":(276,553),u"CH06_08L":(694,651),u"CH06_08M":(337,569),u"CH06_08S":(276,553),u"CH06_09L":(694,651),u"CH06_09M":(337,569),u"CH06_09S":(276,553),u"CH06_10L":(694,651),u"CH06_10M":(337,569),u"CH06_10S":(276,553),u"CH06_11L":(694,651),u"CH06_11M":(337,569),u"CH06_11S":(276,553),u"CH07_01L":(694,651),u"CH07_01M":(337,569),u"CH07_01S":(276,553),u"CH07_02L":(694,651),u"CH07_02M":(337,569),u"CH07_02S":(276,553),u"CH07_03L":(694,651),u"CH07_03M":(337,569),u"CH07_03S":(276,553),u"CH07_04L":(694,651),u"CH07_04M":(337,569),u"CH07_04S":(276,553),u"CH07_05L":(694,651),u"CH07_05M":(337,569),u"CH07_05S":(276,553),u"CH07_06L":(694,651),u"CH07_06M":(337,569),u"CH07_06S":(276,553),u"CH07_07L":(694,651),u"CH07_07M":(337,569),u"CH07_07S":(276,553),u"CH07_08L":(694,651),u"CH07_08M":(337,569),u"CH07_08S":(276,553),u"CH07_09L":(694,651),u"CH07_09M":(337,569),u"CH07_09S":(276,553),u"CH07_10L":(694,651),u"CH07_10M":(337,569),u"CH07_10S":(276,553),u"CH07_11L":(694,651),u"CH07_11M":(337,569),u"CH07_11S":(276,553),u"CJ01_01L":(666,717),u"CJ01_01M":(403,677),u"CJ01_01S":(294,650),u"CJ01_02L":(666,717),u"CJ01_02M":(403,677),u"CJ01_02S":(294,650),u"CJ01_03L":(666,717),u"CJ01_03M":(403,677),u"CJ01_03S":(294,650),u"CK01_01L":(823,697),u"CK01_01M":(597,671),u"CK01_01S":(450,648),u"CK01_02L":(823,697),u"CK01_02M":(597,671),u"CK01_02S":(450,648),u"CK01_03L":(823,697),u"CK01_03M":(597,671),u"CK01_03S":(450,648),u"CK01_04L":(823,697),u"CK01_04M":(597,671),u"CK01_04S":(450,648)}
    i=0
    chara_command=''
    while i < len(command):
        if command[i].startswith('#CHR_DSP '):
            chara=command[i][9:]
            j=chara_in_list(chara_list,chara)
            if j==-1:
                chara_list.append(chara)
            else:
                chara_list[j]=chara
            chara_list=sorted(chara_list)
            chara_command=''
            for j in range(0,len(chara_list),1):
                chara_command+='lsp '+str(200+j)+',"chr/'+chara_list[j]+'.png",'
                chara_command+=str((2*j+1)*400/len(chara_list)-chrdict[chara_list[j]][0]/2)+','
                chara_command+=str(660-chrdict[chara_list[j]][1])+':'
            chara_command+='print 10,300'
        else:
            if chara_command!='':
                script.append(chara_command)
            chara_command=''
            if command[i]==u'Jump':
                if command[i-1].startswith('#CHR_DSP '):
                    chara=command[i-1][9:]
                    j=chara_list.index(chara)
                    jumpcommand='chrposl '+str(200+j)+','
                    jumpcommand+=str((2*j+1)*400/len(chara_list)-chrdict[chara][0]/2)+','
                    jumpcommand+=str(610-chrdict[chara][1])+','
                    jumpcommand+=str((2*j+1)*400/len(chara_list)-chrdict[chara][0]/2)+','
                    jumpcommand+=str(660-chrdict[chara][1])
                    script.append(jumpcommand)
            elif command[i]==u'Down':
                if command[i-1].startswith('#CHR_DSP '):
                    chara=command[i-1][9:]
                    j=chara_list.index(chara)
                    jumpcommand='chrposl '+str(200+j)+','
                    jumpcommand+=str((2*j+1)*400/len(chara_list)-chrdict[chara][0]/2)+','
                    jumpcommand+=str(710-chrdict[chara][1])+','
                    jumpcommand+=str((2*j+1)*400/len(chara_list)-chrdict[chara][0]/2)+','
                    jumpcommand+=str(660-chrdict[chara][1])
                    script.append(jumpcommand)
            elif command[i].startswith('#CHR_ERSW'):
                script.append('csp 200,204:print 10,300')
                chara_list=[]
            elif command[i].startswith('bg '):
                if len(chara_list)>0:
                    script.append('csp 200,204:print 10,300')
                    chara_list=[]
                if command[i+1].startswith(u'Transitiontime '):
                    script.append(command[i]+',10,'+command[i+1][15:])
                elif command[i+1].startswith(u'Transitionmask '):
                    args=command[i+1][15:].split(',')
                    script.append(command[i]+',15,'+args[0]+',"bg/'+args[1]+'.bmp"')
                else:
                    script.append(command[i]+',10,300')
            elif command[i].startswith('Transition'):
                pass
            else:
                script.append(command[i])
        i+=1
    return script

def extract_file(filename):
    f=file(filename,'rb')
    buf=f.read()
    f.close()
    i=0
    print len(buf),'bytes read!'
    command=[]
    addr=[]
    while i < len(buf):
        if buf[i:i+2]=='\x08\x05':
            i+=6
            stringlen=struct.unpack('i',buf[i:i+4])[0]
            i+=4
            command.append(buf[i:2*stringlen+i].decode('utf-16'))
            addr.append(i)
            i+=2*stringlen
        elif buf[i:i+3]=='\x02\x00\x06' and buf[i+3:i+5]!='\x00\x00':
            i+=3
            stringlen=struct.unpack('i',buf[i:i+4])[0]
            i+=4
            try:
                command.append(buf[i:2*stringlen+i].decode('utf-16'))
                addr.append(i)
            except:
                print i,stringlen
                pass
            i+=2*stringlen
        elif buf[i:i+3]=='\x02\x00\x04':
            i+=3
            command.append(str(struct.unpack('i',buf[i:i+4])[0]))
            addr.append(i)
            i+=4
        else:
            i+=1
    del buf
    return command

def split_file(filename,dstfilename):
    configfile=file(filename,'r')
    dstfile=file(dstfilename,'w')
    dstfile.write(codecs.BOM_UTF8)
    dstfile.write('\x3B\xE6\xAD\xA4\xE8\x84\x9A\xE6\x9C\xAC\xE7\xBC\x96\xE5\x86\x99\xE8\x80\x85\xE4\xB8\xBA\x63\x68\x65\x6E\x5F\x78\x69\x6E\x5F\x6D\x69\x6E\x67\x2C\x20\xE6\xB1\x89\xE5\x8C\x96\xE6\x96\x87\xE6\x9C\xAC\xE7\x89\x88\xE6\x9D\x83\xE4\xB8\xBA\x5B\x53\x70\x68\x65\x72\x65\x20\xE4\xB8\xAD\xE6\x96\x87\xE5\x8C\x96\xE5\xA7\x94\xE5\x91\x98\xE4\xBC\x9A\x5D\xE6\x89\x80\xE6\x9C\x89\xEF\xBC\x8C\xE8\xAF\xB7\xE5\x8B\xBF\xE6\x93\x85\xE8\x87\xAA\xE4\xBF\xAE\xE6\x94\xB9\xE6\xAD\xA4\xE8\x84\x9A\xE6\x9C\xAC\xE6\x88\x96\xE7\x9B\xB4\xE6\x8E\xA5\xE5\x8F\x91\xE5\xB8\x83\xE4\xBD\xBF\xE7\x94\xA8\xE6\xAD\xA4\xE8\x84\x9A\xE6\x9C\xAC\xE5\x88\xB6\xE4\xBD\x9C\xE7\x9A\x84\xE4\xBA\xA7\xE5\x93\x81\x0D\x0A\x3B\xE5\xA6\x82\xE9\x9C\x80\xE8\xA6\x81\xE4\xBD\xBF\xE7\x94\xA8\xE6\xAD\xA4\xE8\x84\x9A\xE6\x9C\xAC\xE5\x88\xB6\xE4\xBD\x9C\xE7\xA7\xBB\xE6\xA4\x8D\xE4\xBD\x9C\xE5\x93\x81\xEF\xBC\x8C\xE8\xAF\xB7\xE8\x81\x94\xE7\xB3\xBB\x63\x68\x65\x6E\x5F\x78\x69\x6E\x5F\x6D\x69\x6E\x67\x40\x31\x36\x33\x2E\x63\x6F\x6D\x0D\x0A')
    while True:
        line=configfile.readline()
        if len(line)==0:
            break
        if line[:3] == codecs.BOM_UTF8:
            command=line[3:].decode('utf8')
        else:
            command=line.decode('utf8')
        if command.startswith(u'#FILE '):
            dstfile.close()
            dstfile=file(command[6:-1]+'.txt','w')
            dstfile.write(codecs.BOM_UTF8)
            dstfile.write('\x3B\xE6\xAD\xA4\xE8\x84\x9A\xE6\x9C\xAC\xE7\xBC\x96\xE5\x86\x99\xE8\x80\x85\xE4\xB8\xBA\x63\x68\x65\x6E\x5F\x78\x69\x6E\x5F\x6D\x69\x6E\x67\x2C\x20\xE6\xB1\x89\xE5\x8C\x96\xE6\x96\x87\xE6\x9C\xAC\xE7\x89\x88\xE6\x9D\x83\xE4\xB8\xBA\x5B\x53\x70\x68\x65\x72\x65\x20\xE4\xB8\xAD\xE6\x96\x87\xE5\x8C\x96\xE5\xA7\x94\xE5\x91\x98\xE4\xBC\x9A\x5D\xE6\x89\x80\xE6\x9C\x89\xEF\xBC\x8C\xE8\xAF\xB7\xE5\x8B\xBF\xE6\x93\x85\xE8\x87\xAA\xE4\xBF\xAE\xE6\x94\xB9\xE6\xAD\xA4\xE8\x84\x9A\xE6\x9C\xAC\xE6\x88\x96\xE7\x9B\xB4\xE6\x8E\xA5\xE5\x8F\x91\xE5\xB8\x83\xE4\xBD\xBF\xE7\x94\xA8\xE6\xAD\xA4\xE8\x84\x9A\xE6\x9C\xAC\xE5\x88\xB6\xE4\xBD\x9C\xE7\x9A\x84\xE4\xBA\xA7\xE5\x93\x81\x0D\x0A\x3B\xE5\xA6\x82\xE9\x9C\x80\xE8\xA6\x81\xE4\xBD\xBF\xE7\x94\xA8\xE6\xAD\xA4\xE8\x84\x9A\xE6\x9C\xAC\xE5\x88\xB6\xE4\xBD\x9C\xE7\xA7\xBB\xE6\xA4\x8D\xE4\xBD\x9C\xE5\x93\x81\xEF\xBC\x8C\xE8\xAF\xB7\xE8\x81\x94\xE7\xB3\xBB\x63\x68\x65\x6E\x5F\x78\x69\x6E\x5F\x6D\x69\x6E\x67\x40\x31\x36\x33\x2E\x63\x6F\x6D\x0D\x0A')
        else:
            dstfile.write(command.encode('utf8'))
    configfile.close()
    dstfile.close()
    
#main
command=extract_file('yosuga.csx')
script=parse_script(command)
outputlist(modify_script(script))
#split_file('1.txt','00_a001.txt')

#command=readyosugafile('yosuga.txt')
#script=fixyosugafile(command)
#outputlist(script)
###sort the command by frequency
##frequency={}
##i=0
##while i < len(command):
##    if allareeng(command[i]):
##        if frequency.has_key(command[i]):
##            frequency[command[i]]+=1
##        else:
##            frequency[command[i]]=1
##    i+=1
##sorted_frequency=sorted(frequency.items(),key=lambda d:d[1],reverse=True)
##outputlist(sorted_frequency)














